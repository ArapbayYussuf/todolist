{% extends 'base.html' %}

{% block content %}
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h2 class="text-center mb-4">Ваш профиль</h2>
            <div id="profile-details" class="card p-4">
                <p><strong>Имя пользователя:</strong> <span id="username"></span></p>
                <p><strong>Электронная почта:</strong> <span id="email"></span></p>
            </div>
            <div id="profile-message" class="mt-3 text-center"></div>
        </div>
    </div>

    <script>
        // Получение данных пользователя
        fetch('/api/users/me/', {
            method: 'GET',
            headers: {
                'Authorization': 'Bearer ' + localStorage.getItem('access_token')
            }
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Не удалось загрузить данные пользователя');
            }
            return response.json();
        })
        .then(data => {
            document.getElementById('username').textContent = data.username;
            document.getElementById('email').textContent = data.email;
        })
        .catch(error => {
            const messageDiv = document.getElementById('profile-message');
            messageDiv.innerHTML = '<div class="alert alert-danger">Ошибка: ' + error.message + '</div>';
        });
    </script>
{% endblock %}